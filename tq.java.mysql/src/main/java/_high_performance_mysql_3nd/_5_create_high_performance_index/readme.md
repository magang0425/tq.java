2018-03-17



### 自适应哈希索引

### 伪哈希索引
1. 



### 索引策略

#### 独立的列
1. 索引列不能是表达式的一部分, 也不能使函数的参数

#### 前缀索引以及索引选择性
1. 选择足够长的前缀已保证较高的选择性, 同时永不能太长(节约空间)
2. 为了决定前缀的合适长度, 需要找到最常见的值得列表, 然后和最常见的前缀进行比较

#### 多列索引
1. 

#### 选择合适的索引列顺序
1. 

### 聚簇索引
1. 对磁盘上实际数据重新组织以按指定的一个或多个列的值排序的算法。特点是存储数据的顺序和索引顺序一致
2. 一般情况下主键会默认创建聚簇索引，且一张表只允许存在一个聚簇索引
3. 在 InnoDB 中, 聚簇索引 "就是" 表

### 聚簇索引的优点
1. 把相关的数据保存在一起
2. 数据访问更快
3. 使用覆盖索引扫描的查询可以直接使用页节点中的主键值

### 聚簇索引的缺点
1. 最大限度的提高了IO密集型应用的性能, 但是如果数据全部都放在内存中, 优势就不能明显了
2. 插入速度依赖于 插入排序
3. 更新聚簇索引列的代价更高, 强制 InnoDB 将每一个被更新的列移动到新的位置
4. 在插入新行 或者是 主键被更新需要移动行的时候, 可能面临 "页分裂" 的问题,

### 二级索引
1. mysql中每个表都有一个聚簇索引（clustered index ），除此之外的表上的每个非聚簇索引都是二级索引，又叫辅助索引（secondary indexes）
2. 以InnoDB来说，每个InnoDB表具有一个特殊的索引称为聚集索引。如果您的表上定义有主键，该主键索引是聚集索引。如果你不定义为您的
表的主键时，MySQL取第一个唯一索引（unique）而且只含非空列（NOT NULL）作为主键，InnoDB使用它作为聚集索引。如果没有这样的列，
InnoDB就自己产生一个这样的ID值，它有六个字节，而且是隐藏的，使其作为聚簇索引
1. 二级索引叶子节点保存的不是指向行的物理地址, 而是行的主键值
2. 通过二级索引查找行, 需要存储引擎找到二级索引的叶子节点获取对应的主键值, 然后根据这个主键值去聚簇索引中查找对应的行

### 顺序的主键什么时候会造成更坏的结果
1. 主键的上界 会成为 "热点", 并发插入导致 间隙锁
2. AUTO_INCREMENT 锁机制


### 覆盖索引
1. 覆盖索引必须存储索引列的值, 而哈希索引,空间索引和全文索引等都不存储索引的值, 所以Mysql只能使用 B-Tree 索引做覆盖索引
2. 

### 总结:
1. 尽可能选择合适的索引以避免单行查找
2. 使用数据原生顺序从而避免额外的排序操作
3. 使用索引覆盖查询