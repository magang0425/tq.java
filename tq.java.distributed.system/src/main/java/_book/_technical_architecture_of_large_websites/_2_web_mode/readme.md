2018-12-13

## 大型网站架构模式

### 分层
1. 具体
    - 应用层
        - 具体业务与视图展示: 网站首页以及搜索输入和结果展示
    - 服务层
        - 为应用层提供服务支持: 用户管理, 购物车
    - 数据层
        - 提供数据访问服务: 数据库, 缓存, 文件, 搜索引擎
2. 好处
    - 分工合作开发与维护
    - 具有独立性, 维持接口不变, 各层可以调整
3. 问题
    - 合理规划层次边界和接口
    - 严格遵守分层架构的约束, 
    - 禁止跨层次调用以及逆调用
    
### 分割
1. vs 分层
    - 分层横向 那么 分割就是纵向了
2. 没有最细只有更细

### 分布式
1. **分层和分割的主要目的是为了切分后的模块便于分布式部署**
2. 带来的问题
    - 网络
    - 服务器宕机的可能性增加, 一个服务器宕机可能导致上游服务不可用, 可用性降低
    - 数据在分布式环境下的数据一致性问题, 分布式事务
    - 开发与维护成本增加
3. 场景
    - 分布式应用和服务
    - 分布式静态资源
    - 分布式数据与存储
    - 分布式计算
    - 分布式配置
    - 分布式锁
    - 分布式文件

### 集群
1. 几台服务器部署相同的应用构建一个集群, 通过负载均衡设备共同对外提供服务
2. 提高可用性

### 缓存
1. **将数据放在距离计算最近的位置**
2. 具体
    - CDN
        - 内容分发网络
    - 反向代理
    - 本地缓存
    - 分布式缓存
3. 使用缓存的前提条件
    - 数据访问热点不均衡
    - 数据在某个时间段内有效, 不会很快过期
        - 因为失效产生脏读
        
### 异步
1. 应用内使用本地队列缓存, 多个应用之间使用消息队列
2. 作用
    - 提高可用性
    - 加快网站访问速度
    - 消除并发访问高峰

### 冗余

### 自动化
1. 自动化代码管理
2. 自动化测试
3. 自动化安全监测
3. 自动化部署
3. 线上
    - 自动化监控
    - 自动化报警
    - 自动化失效转移
    - 自动化失效恢复
    - 自动化降级
    
    