2018-04-08

## 查询缓存(缓存完整的Select 查询结果)
***

### 概念
1. 如果查询语句中包含任何的不确定函数, 在查询缓存中是不可能找到缓存结果的

### 额外的消耗
1. 读查询开始之前不许先检查是否命中缓存
1. 如果这个读查询可以缓存, 当执行完查询后, 会将结果存入查询缓存
1. 当向某张表写入数据时, 必须将对应表的缓存都设置失效. 如果查询缓存非常大或者是碎片非常多, 带来很大的系统消耗
2. 因为缓存失效操作需要一个全局锁的保护, 当缓存使用了大量内存的时候, 缓存失效的操作可能会成为一个性能瓶颈

### 缓存碎片
1. Mysql回收剩余数据块空间时, 回收的数据块小于 query_cache_min_res_unit, 就会留下魂村碎片

### 是否打开查询缓存
1. 可以通过观察打开 和 关闭 查询缓存时候的 系统效率来决定
2. 如果网络传输消耗是 主要瓶颈, 查询缓存的作用就很小了
3. 消耗大量系统的资源的查询适合缓存
    - 汇总计算查询: count()
    - 复杂的select语句: join后的排序与分页
    - 涉及的更新操作比 select少
4. 命中与写入的比例: Qache_hits VS Qcache_inserts    