2019-01-23

## Mysql 体系结构和存储引擎

### 安装
1. https://www.cnblogs.com/wangmingshun/p/7710483.html

### 数据库与实例
1. 数据库
    - 物理操作系统文件或其他形式文件类型的集合
2. 实例
    - Mysql 数据库由后台线程以及一个共享内存区组成
    - 数据库实例才是真正用于操作数据库文件的
3. 配置文件
    - 启动需要
    - /etc/my.cnf --> /etc/mysql/my.cnf --> /usr/local/mysql/etc/my.cnf --> ~/.my.cnf
    - 会有默认参数设置启动实例   
    
### Mysql 体系结构
![](1.jpg)

1. 连接池组件
2. 管理服务和工具组件
3. Sql 接口组件
4. 查询分析器组件
5. 优化器组件
6. 缓冲组件
7. 插件式存储引擎
    - **基于表 而不是 基于数据库**
    - 提供一系列标准的管理和服务支持, 这些标准和存储引擎本身无关
8. 物理文件 

### Mysql 存储引擎
1. InnoDB 存储引擎
    - 事务
    - 行锁设计
    - 支持外键
    - 读不产生锁
    - MVCC
        - 高并发性
    - 4种隔离级别, 默认 repeatable
    - next-key-locking(间隙锁) 避免幻读
    - 插入缓冲(insert buffer), 二次写(double write), 自适应哈希索引(adaptive hash index), 预读(read ahead)
    - 聚集
        - 数据存储采用 聚集 的方式, 每个表的存储都是按照主键的顺序进行存放
        - 如果没有显式的定义指定主键,  为每一行生成一个 6字节的 ROWID, 作为主键
2. MyISAM 存储引擎
    - 不支持事务, 不支持表锁设计
    - 支持全文索引
    - 缓冲池值缓存索引文件, 而不缓存数据文件
    - 由 MYD 和 MYI 组成
        - MYD: 数据文件
        - MYI: 索引文件
3. NOB 引擎
    - 
     